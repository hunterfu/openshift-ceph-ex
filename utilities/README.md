## Openshift Test Script

The [oc-test](oc-test) script can be used to verify/validate an OSE environment (specifying --verify) or verify the OSE setup and also run one or more test suites.

Here's is the full syntax, which is displayed when all script arguments are omitted:

```
  oc-test - execute one or more ose storage tests

SYNTAX
  oc-test [test-name] [options]

DESCRIPTION
  Verifies the ose-master environment and, optionally, executes one or more
  storage tests on the ose-master server.

  test-name  A list of one or more tests to run. Expected values are:
               general (default),
               nfs,
               gluster,
               rbd (or ceph),
               all.
             More than one test is specified with a comma separator, eg.
             "nfs,gluster".

  --verify   Only test the ose enviromment but don't run any tests.
  --master <node>
             Hostname or ip of the ose-master node, default is local host
  --oc-prefix <path>
             An optional path prefix appended to all "oc" commands, eg.
             "/root/origin/_output/local/bin/linux/amd64" for local ose builds.
  --sgid <number>
             An optional supplemental group ID to be applied to the pods created
             by various tests. If omitted the default is the first id in the
             supplemental group ID range defined for the current project. See:
               $ oc get ns <project> -o yaml  # for the various IDs
  --nfs-server <hostname|ip>
             NFS server's hostname or ip. Required if performing the nfs tests,
             otherwise ignored.
  --gluster-nodes <node-list>
             A list of 2 or more gluster storage node IP addresses (comma
             separator), which become the ose endpoints. Hostnames are converted
             to IPs using getent, but if DNS or /etc/hosts is not setup
             correctly it is better to supply IPs. Required if performing the
             gluster tests, otherwise ignored. Eg.:
               192.168.122.21,192.168.122.22
  --gluster-vol <volName>
             The name of an existing gluster/RHS volume. Required if performing
             the gluster tests, otherwise ignored.
  --rbd-monitors <node-list>
             A list of 1 or more ceph Monitor IP addresses (comma separated).
             Hostnames are converted to IPs using getent, but if DNS or
             /etc/hosts is not setup correctly it is better to supply the IP.
             If the default port of 6789 is not used then :portNum must follow
             all IPs not using the default port.  Required if performing the 
             ceph-rbd tests, otherwise ignored. Eg:
               192.168.122.133:6788,192.168.122.134
  --ceph-secret64 <base64 value>
             The base-64 encoded secret string generated by running:
               ceph auth get-key client.admin  , followed by pasting that output
             to the base64 command:
               echo -n "<output-from-ceph-auth-get-key>" | base64
             If omitted and the rbd test is requested and a provided ceph 
             monitor is reachable via ssh, then this value is calculated by the
             rbd test and is not required. It is ignore by all tests other than
             the ceph-rbd tests.
  --rbd-image <name>
             The name of the ceph-rbd image. If the rbd pool is not defaulted to
             "rbd" then the pool name is also required in the form of:
               <pool-name>/<image-name>
             Ignored for all tests other than the ceph-rbd tests.
  --version  Show the version string.
  -q         Suppress all prompts and reduce instructional output.
```

### Examples:
 1. To simply verify the target OSE environment, where "rhel7-ose-1" is the name of the OSE master host:
  ```
  ./oc-test --verify --master rhel7-ose-1
  
  *** Only validating the environment on ose-master "rhel7-ose-1"

*** Validating ose-master: "rhel7-ose-1"...

Login successful.

Using project "default".

You have access to the following projects and can switch between them with 'oc project <projectname>':

  * default (current)
  * openshift
  * openshift-infra

... validated

===================================
 Master node     : rhel7-ose-1
 Current project : default
   Sup User IDs  : 12345/10
   Sup Group IDs : 5555-5555,1000000000/10000
 Supplied Sup GID: <none>
 Pod's Group ID  : 5555
===================================
  ```

 2. To verify the target OSE environment and use a non-official version of origin (on the same master):
  ```
./oc-test --verify --master rhel7-ose-1 --oc-prefix /root/origin/_output/local/bin/linux/amd64
  ```

 3. To run the most basic test suite ("general" tests), which are the default if no tests are requested, using the same master host:
  ```
  ./oc-test --master rhel7-ose-1

*** Will run 1 test on ose-master "rhel7-ose-1":
       general

*** Validating ose-master: "rhel7-ose-1"...

Login successful.

Using project "default".

You have access to the following projects and can switch between them with 'oc project <projectname>':

  * default (current)
  * openshift
  * openshift-infra
... validated
...
*** Executing tests ...

*** General test suite ***"

    These baseline tests test that SGID  works in emptyDir and in
    hostPath. No PVs or claims are used here.

Press any key to continue...

----------
General Test 1: busybox, emptyDir, SGID 5555:
... deleting pod "general-pod1" (if it exists)...
pod "general-pod1" created
... checking pod "general-pod1" ...

----------
General Test 2: busybox, hostPath plugin, SGID 5555:
... deleting pod "general-pod2" (if it exists)...
pod "general-pod2" created
... checking pod "general-pod2" ...

***
*** Done with tests: 0 errors
***
  ```
  Use ``` -q ``` to suppress the "continue" prompt and reduce instructional output.
  
